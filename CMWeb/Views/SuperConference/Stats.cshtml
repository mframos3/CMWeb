@using Newtonsoft.Json.Linq
@model IEnumerable<CMWeb.Models.SuperConference>

@{
    ViewData["Title"] = "Index";
}

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>

<h1>Estad√≠sticas</h1>
<body>



<div class="container">
    <div class="row">
        <div class="col-sm">
            <canvas id="myChart"></canvas>
        </div>
        <div class="col-sm">
            <canvas id="myChart1"></canvas>
        </div>
    </div>
    <div class="row">
            <div class="col-sm">
                <canvas id="myChart2"></canvas>
            </div>
            <div class="col-sm">
                <canvas id="myChart3"></canvas>
            </div>
        </div>
</div>

 
@foreach (var item in (List<string>) ViewData["Events"])
{
    <p>@item</p>
    <p>@JObject.Parse(item)["Attendance"]</p>
}

@foreach (var item in (List<string>) ViewData["ConferencesEventsAttendance"])
 {
     <p>@item</p>
 }
<br/>
  <h1>EVENTSATTENDANCE</h1>
  
  @foreach (var item in (List<string>) ViewData["EventsAttendance"])
   {
       <p>@item</p>
   }
<br/>
<h1>CONFERENCETRACKSATTENDANCE</h1>

@foreach (var item in (List<string>) ViewData["ConferencesTrackAttendance"])
 {
     <p>@item</p>
 }
<br/>
<h1>TRACKSATTENDANCE</h1>

@foreach (var item in (List<string>) ViewData["TracksAttendance"])
 {
     <p>@item</p>
 }
<h1>CONFERENCEEVENTSRATINGS</h1>

@foreach (var item in (List<string>) ViewData["ConferencesEventsRatings"])
 {
     <p>@item</p>
 }
<h1>EventsRatings</h1>

@foreach (var item in (List<string>) ViewData["EventsRatings"])
 {
     <p>@item</p>
 }
<h1>CONFERENCESTRACKRATINGS</h1>

@foreach (var item in (List<string>) ViewData["ConferencesTrackRating"])
 {
     <p>@item</p>
 }
<h1>TRACKSRATING</h1>

@foreach (var item in (List<string>) ViewData["TracksRating"])
 {
     <p>@item</p>
 }
<h1>SPEAKERSRATING</h1>

@foreach (var item in (List<string>) ViewData["SpeakersRating"])
 {
     <p>@item</p>
 }
</body>

<script>
function getRandomColor() {
      var letters = '0123456789ABCDEF';
      var color = '#';
      for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }
</script>


<script>
    const data = [{name: "conf1", data: [{event: "ev1", attendance: 1}, {event: "ev2", attendance: 2}, {event: "ev3", attendance: 1}]},
                  {name: "conf2", data: [{event: "ev1", attendance: 2}, {event: "ev2", attendance: 3}, {event: "ev3", attendance: 4}]}];
    
    var myChart = document.getElementById('myChart').getContext('2d');
    var eventsName = [];
    var confsName = [];
    
    let datasets = []
    let datasetsEv = []
    
    for (let d of data)
        {   
            let attendance = []
            for (let e of d.data)
                {
                                if (! eventsName.includes(e.event))
                                {
                                    eventsName.push(e.event)
                                }
                                attendance.push(e.attendance)

                }
            let data = {label: d.name, data: attendance, backgroundColor: getRandomColor()}
            datasets.push(data)
            
           
        }
   
    var massPopChart = new Chart(myChart, {
        type: "bar",
        data: {
            labels: eventsName,
            datasets: datasets
        },
        options: {
             scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            precision: 0
                        }
                    }]
                },
            title: {
                display: true,
                text: "Attendance",
                fontSize: 25
            },
            legend: {
               position: "right",
               labels : {
                   fontColor: "#000"
               } 
            }
        }
    });
</script>

<script>

    const dataEv = [{name: "ev1", data: [{conference: "conf1", attendance: 1}, {conference: "conf2", attendance: 2}]},
                        {name: "ev2", data: [{conference: "conf1", attendance: 2}, {conference: "conf2", attendance: 3}]},
                        {name: "ev3", data: [{conference: "conf1", attendance: 1}, {conference: "conf2", attendance: 4}]}]
        

    
    var myChart2 = document.getElementById('myChart1').getContext('2d');
    
    for (let d of dataEv)
                {   
                    let attendance = []
                    for (let e of d.data)
                        {
                                        if (! confsName.includes(e.conference))
                                        {
                                            confsName.push(e.conference)
                                        }
                                        attendance.push(e.attendance)
        
                        }
                    
                    let data = {label: d.name, data: attendance, backgroundColor: getRandomColor()}
                    datasetsEv.push(data)
                    
                   
                }
    
    var massPopChart2 = new Chart(myChart2, {
        type: "bar",
        data: {
            labels: confsName,
            datasets: datasetsEv
        },
        options: {
             scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            precision: 0
                        }
                    }]
                },
            title: {
                display: true,
                text: "Attendance",
                fontSize: 25
            },
            legend: {
               position: "right",
               labels : {
                   fontColor: "#000"
               } 
            }
        }
    });
</script>


<script>
    const dataTrackConf = [{name: "conf1", data: [{track: "t1", attendance: 5}, {track: "t2", attendance: 4}, {track: "t3", attendance: 5}]},
                            {name: "conf2", data: [{track: "t1", attendance: 3}, {track: "t2", attendance: 1}, {track: "t3", attendance: 4}]}];
    
    
    var myChart3 = document.getElementById('myChart2').getContext('2d');
    var tracksName = []
    var datasetTrack = []
    
    for (let d of dataTrackConf)
        {   
            let attendance = []
            for (let t of d.data)
                {
                                if (! tracksName.includes(t.track))
                                {
                                    tracksName.push(t.track)
                                }
                                attendance.push(t.attendance)

                }
            let data = {label: d.name, data: attendance, backgroundColor: getRandomColor()}
            datasetTrack.push(data)
            
           
        }
   
    var massPopChart3 = new Chart(myChart3, {
        type: "bar",
        data: {
            labels: tracksName,
            datasets: datasetTrack
        },
        options: {
             scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            precision: 0
                        }
                    }]
                },
            title: {
                display: true,
                text: "Attendance",
                fontSize: 25
            },
            legend: {
               position: "right",
               labels : {
                   fontColor: "#000"
               } 
            }
        }
    });
</script>


<script>

    const dataConfTrack = [{name: "t1", data: [{conference: "conf1", attendance: 1}, {conference: "conf2", attendance: 2}]},
                           {name: "t2", data: [{conference: "conf1", attendance: 2}, {conference: "conf2", attendance: 3}]},
                           {name: "t3", data: [{conference: "conf1", attendance: 1}, {conference: "conf2", attendance: 4}]}]
        
    var datasetConfTrack = []
    
    var myChart4 = document.getElementById('myChart3').getContext('2d');
    
    for (let d of dataConfTrack)
                {   
                    let attendance = []
                    for (let e of d.data)
                        {
                                        attendance.push(e.attendance)
        
                        }
                    
                    let data = {label: d.name, data: attendance, backgroundColor: getRandomColor()}
                    datasetConfTrack.push(data)
                    
                   
                }
    
    var massPopChart3 = new Chart(myChart4, {
        type: "bar",
        data: {
            labels: confsName,
            datasets: datasetConfTrack
        },
        options: {
             scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            precision: 0
                        }
                    }]
                },
            title: {
                display: true,
                text: "Attendance",
                fontSize: 25
            },
            legend: {
               position: "right",
               labels : {
                   fontColor: "#000"
               } 
            }
        }
    });
</script>
    